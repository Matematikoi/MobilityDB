<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 10. Temporal Types: Aggregation and Indexing</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.1 User's Manual"><link rel="up" href="index.html" title="MobilityDB 1.1 User's Manual"><link rel="prev" href="ch09s04.html" title="Multidimensional Tiling"><link rel="next" href="ch10s02.html" title="Indexing"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 10. Temporal Types: Aggregation and Indexing</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch09s04.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch10s02.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="temporal_types_aggregation"></a>Chapter 10. Temporal Types: Aggregation and Indexing</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="ch10.html#temporal_types_aggregations">Aggregation</a></span></dt><dt><span class="sect1"><a href="ch10s02.html">Indexing</a></span></dt><dt><span class="sect1"><a href="ch10s03.html">Statistics and Selectivity</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch10s03.html#idm5895">Statistics Collection</a></span></dt><dt><span class="sect2"><a href="ch10s03.html#idm5968">Selectivity Estimation</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="temporal_types_aggregations"></a>Aggregation</h2></div></div></div><p>The temporal aggregate functions generalize the traditional aggregate functions. Their semantics is that they compute the value of the function at every instant in the <span class="emphasis"><em>union</em></span> of the temporal extents of the values to aggregate. In contrast, recall that all other functions manipulating temporal types compute the value of the function at every instant in the <span class="emphasis"><em>intersection</em></span> of the temporal extents of the arguments.</p><p>The temporal aggregate functions are the following ones:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>For all temporal types, the function <code class="varname">tcount</code> generalize the traditional function <code class="varname">count</code>. The temporal count can be used to compute at each point in time the number of available objects (for example, number of cars in an area).</p></li><li class="listitem"><p>For all temporal types, function <code class="varname">extent</code> returns a bounding box that encloses a set of temporal values. Depending on the base type, the result of this function can be a <code class="varname">tstzspan</code>, a <code class="varname">tbox</code> or an <code class="varname">stbox</code>.</p></li><li class="listitem"><p>For the temporal Boolean type, the functions <code class="varname">tand</code> and <code class="varname">tor</code> generalize the traditional functions <code class="varname">and</code> and <code class="varname">or</code>.</p></li><li class="listitem"><p>For temporal numeric types, there are two types of temporal aggregate functions. The functions <code class="varname">tmin</code>, <code class="varname">tmax</code>, <code class="varname">tsum</code>, and <code class="varname">tavg</code> generalize the traditional functions <code class="varname">min</code>, <code class="varname">max</code>, <code class="varname">sum</code>, and <code class="varname">avg</code>. Furthermore, the functions <code class="varname">wmin</code>, <code class="varname">wmax</code>, <code class="varname">wcount</code>, <code class="varname">wsum</code>, and <code class="varname">wavg</code> are window (or cumulative) versions of the traditional functions that, given a time interval w, compute the value of the function at an instant t by considering the values during the interval [t-w, t]. All window aggregate functions are available for temporal integers, while for temporal floats only window minimum and maximum are meaningful.</p></li><li class="listitem"><p>For the temporal text type, the functions <code class="varname">tmin</code> y <code class="varname">tmax</code> generalize the traditional functions <code class="varname">min</code> and <code class="varname">max</code>.</p></li><li class="listitem"><p>Finally, for temporal point types, the function <code class="varname">tcentroid</code> generalizes the function <code class="varname">ST_Centroid</code> provided by PostGIS. For example, given set of objects that move together (that is, a convoy or a flock) the temporal centroid will produce a temporal point that represents at each instant the geometric center (or the center of mass) of all the moving objects.</p></li></ul></div><p>In the examples that follow, we suppose the tables <code class="varname">Department</code> and <code class="varname">Trip</code> contain the two tuples introduced in <a class="xref" href="ch04s02.html" title="Examples of Temporal Types">the section called “Examples of Temporal Types”</a>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="tcount"></a><a class="indexterm" name="idm5702"></a><p>Temporal count</p><p><code class="varname">tcount(ttype) → {tint_seq,tint_seqset}</code></p><pre class="programlisting">
SELECT tcount(NoEmps) FROM Department;
-- {[1@2001-01-01, 2@2001-02-01, 1@2001-08-01, 1@2001-10-01)}
</pre></li><li class="listitem"><a name="extent"></a><a class="indexterm" name="idm5710"></a><p>Bounding box extent</p><p><code class="varname">extent(temp) → {tstzspan,tbox,stbox}</code></p><pre class="programlisting">
SELECT extent(noEmps) FROM Department;
-- TBOX XT((4,12),[2001-01-01,2001-10-01])
SELECT extent(Trip) FROM Trips;
-- STBOX XT(((0,0),(3,3)),[2001-01-01 08:00:00+01, 2001-01-01 08:20:00+01))
</pre></li><li class="listitem"><a name="tand"></a><a class="indexterm" name="idm5718"></a><p>Temporal and</p><p><code class="varname">tand(tbool) → tbool</code></p><pre class="programlisting">
SELECT tand(NoEmps #&gt; 6) FROM Department;
-- {[t@2001-01-01, f@2001-04-01, f@2001-10-01)}
</pre></li><li class="listitem"><a name="tor"></a><a class="indexterm" name="idm5726"></a><p>Temporal or</p><p><code class="varname">tor(tbool) → tbool</code></p><pre class="programlisting">
SELECT tor(NoEmps #&gt; 6) FROM Department;
-- {[t@2001-01-01, f@2001-08-01, f@2001-10-01)}
</pre></li><li class="listitem"><a name="tmin"></a><a class="indexterm" name="idm5734"></a><p>Temporal minimum</p><p><code class="varname">tmin(ttype) → ttype</code></p><pre class="programlisting">
SELECT tmin(NoEmps) FROM Department;
-- {[10@2001-01-01, 4@2001-02-01, 6@2001-06-01, 6@2001-10-01)}
</pre></li><li class="listitem"><a name="tmax"></a><a class="indexterm" name="idm5742"></a><p>Temporal maximum</p><p><code class="varname">tmax(ttype) → ttype</code></p><pre class="programlisting">
SELECT tmax(NoEmps) FROM Department;
-- {[10@2001-01-01, 12@2001-04-01, 6@2001-08-01, 6@2001-10-01)}
</pre></li><li class="listitem"><a name="tsum"></a><a class="indexterm" name="idm5750"></a><p>Temporal sum</p><p><code class="varname">tsum(tnumber) → {tnumber_seq,tnumber_seqset}</code></p><pre class="programlisting">
SELECT tsum(NoEmps) FROM Department;
/* {[10@2001-01-01, 14@2001-02-01, 16@2001-04-01, 18@2001-06-01, 6@2001-08-01,
   6@2001-10-01)} */
</pre></li><li class="listitem"><a name="tavg"></a><a class="indexterm" name="idm5758"></a><p>Temporal average</p><p><code class="varname">tavg(tnumber) → {tfloat_seq,tfloat_seqset}</code></p><pre class="programlisting">
SELECT tavg(NoEmps) FROM Department;
/* {[10@2001-01-01, 10@2001-02-01), [7@2001-02-01, 7@2001-04-01),
   [8@2001-04-01, 8@2001-06-01), [9@2001-06-01, 9@2001-08-01),
   [6@2001-08-01, 6@2001-10-01) */
</pre></li><li class="listitem"><a name="wmin"></a><a class="indexterm" name="idm5766"></a><p>Window minimum</p><p><code class="varname">wmin(tnumber,interval) → {tnumber_seq,tnumber_seqset}</code></p><pre class="programlisting">
SELECT wmin(NoEmps, interval '2 days') FROM Department;
-- {[10@2001-01-01, 4@2001-04-01, 6@2001-06-03, 6@2001-10-03)}
</pre></li><li class="listitem"><a name="wmax"></a><a class="indexterm" name="idm5774"></a><p>Window maximum</p><p><code class="varname">wmax(tnumber,interval) → {tnumber_discseq,tnumber_seqset}</code></p><pre class="programlisting">
SELECT wmax(NoEmps, interval '2 days') FROM Department;
-- {[10@2001-01-01, 12@2001-04-01, 6@2001-08-03, 6@2001-10-03)}
</pre></li><li class="listitem"><a name="wcount"></a><a class="indexterm" name="idm5782"></a><p>Window count</p><p><code class="varname">wcount(tnumber,interval) → {tint_seq,tint_seqset}</code></p><pre class="programlisting">
SELECT wcount(NoEmps, interval '2 days') FROM Department;
/* {[1@2001-01-01, 2@2001-02-01, 3@2001-04-01, 2@2001-04-03, 3@2001-06-01, 2@2001-06-03,
   1@2001-08-03, 1@2001-10-03)} */
</pre></li><li class="listitem"><a name="wsum"></a><a class="indexterm" name="idm5790"></a><p>Window sum</p><p><code class="varname">wsum(tint,interval) → {tint_seq,tint_seqset}</code></p><pre class="programlisting">
SELECT wsum(NoEmps, interval '2 days') FROM Department;
/* {[10@2001-01-01, 14@2001-02-01, 26@2001-04-01, 16@2001-04-03, 22@2001-06-01,
   18@2001-06-03, 6@2001-08-03, 6@2001-10-03)} */
</pre></li><li class="listitem"><a name="wavg"></a><a class="indexterm" name="idm5798"></a><p>Window average</p><p><code class="varname">wavg(tint,interval) → {tfloat_seq,tfloat_seqset}</code></p><pre class="programlisting">
SELECT wavg(NoEmps, interval '2 days') FROM Department;
/* {[10@2001-01-01, 10@2001-02-01), [7@2001-02-01, 7@2001-04-01),
   [8.66666666666667@2001-04-01, 8.66666666666667@2001-04-03),
   [8@2001-04-03, 8@2001-06-01),
   [7.33333333333333@2001-06-01, 7.33333333333333@2001-06-03),
   [9@2001-06-03, 9@2001-08-03), [6@2001-08-03, 6@2001-10-03)} */
</pre></li><li class="listitem"><a name="tcentroid"></a><a class="indexterm" name="idm5806"></a><p>Temporal centroid</p><p><code class="varname">tcentroid(tgeompoint) → tgeompoint</code></p><pre class="programlisting">
SELECT tcentroid(Trip) FROM Trips;
/* {[POINT(0 0)@2001-01-01 08:00:00+00, POINT(1 0)@2001-01-01 08:05:00+00),
   [POINT(0.5 0)@2001-01-01 08:05:00+00, POINT(1.5 0.5)@2001-01-01 08:10:00+00,
   POINT(2 1.5)@2001-01-01 08:15:00+00),
   [POINT(2 2)@2001-01-01 08:15:00+00, POINT(3 3)@2001-01-01 08:20:00+00)} */
</pre></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch09s04.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch10s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Multidimensional Tiling </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Indexing</td></tr></table></div></body></html>
